---
kube_module_dependent:
  - 'overlay'
  - 'br_netfilter'

kube_kernel_parameters:
  - { variable: 'net.bridge.bridge-nf-call-iptables', value: '1' }
  - { variable: 'net.bridge.bridge-nf-call-ip6tables', value: '1', create: '{{ ansible_all_ipv6_addresses is none }}' }

kube_registry_server: 'gcr.azk8s.cn/google_containers'
#kube_registry_server: 'registry.aliyuncs.com/google_containers'

kube_cni_plugins:
  calico:
    cidr: '192.168.0.0/16'
    manifests:
      - 'http://docs.projectcalico.org/v{{ kube_network.version }}/manifests/calico.yaml'
  flannel:
    cidr: '10.244.0.0/16'
    manifests:
      - 'http://raw.githubusercontent.com/coreos/flannel/v{{ kube_network.version }}/Documentation/kube-flannel.yml'
  kube-router:
    manifests:
      - 'http://raw.githubusercontent.com/cloudnativelabs/kube-router/v{{ kube_network.version }}/daemonset/kubeadm-kuberouter.yaml'

kube_servers: "\
  {% set _kube_servers = [] %}\
  {% for host in groups[group_names[-1]] %}\
    {% set _kube_node_role = hostvars[host]['kube_node_role'] | default('node', true) %}\
    {% if ( _kube_node_role == 'master') %}\
      {% if _kube_servers.append(hostvars[host]['ansible_host']) %}{% endif %}\
    {% endif %}\
  {% endfor %}\
  {{ _kube_servers }}"
